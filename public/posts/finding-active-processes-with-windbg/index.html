<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Finding Active Processes with Windbg | Stephan Bridger</title><meta name=keywords content="windows,windbg"><meta name=description content="In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure.  A snippet from _EPROCESS as documented on Vergilius Project:
volatile ULONGLONG OwnerProcessId;
struct _PEB* Peb;
struct _MM_SESSION_SPACE* Session;
VOID* Sparel;
In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like dt nt!_EPROCESS in windbg and get a peek at the layout. We&rsquo;ll have to enable kernel debugging to more closely examine things. But here&rsquo;s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:"><meta name=author content="Stephan Bridger"><link rel=canonical href=https://hexagram.foo/posts/finding-active-processes-with-windbg/><link crossorigin=anonymous href=/assets/css/stylesheet.793a8ff569756a2027f6b93c889ec37d86f8750c1c450ebac658c67d856ed6af.css integrity="sha256-eTqP9Wl1aiAn9rk8iJ7DfYb4dQwcRQ66xljGfYVu1q8=" rel="preload stylesheet" as=style><link rel=icon href=https://hexagram.foo/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hexagram.foo/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hexagram.foo/favicon-32x32.png><link rel=apple-touch-icon href=https://hexagram.foo/apple-touch-icon.png><link rel=mask-icon href=https://hexagram.foo/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hexagram.foo/posts/finding-active-processes-with-windbg/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://hexagram.foo/posts/finding-active-processes-with-windbg/"><meta property="og:site_name" content="Stephan Bridger"><meta property="og:title" content="Finding Active Processes with Windbg"><meta property="og:description" content="In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure. A snippet from _EPROCESS as documented on Vergilius Project:
volatile ULONGLONG OwnerProcessId; struct _PEB* Peb; struct _MM_SESSION_SPACE* Session; VOID* Sparel; In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like dt nt!_EPROCESS in windbg and get a peek at the layout. We’ll have to enable kernel debugging to more closely examine things. But here’s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-02T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-02T00:00:00+00:00"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Windbg"><meta property="og:image" content="https://hexagram.foo/fog.jpeg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hexagram.foo/fog.jpeg"><meta name=twitter:title content="Finding Active Processes with Windbg"><meta name=twitter:description content="In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure.  A snippet from _EPROCESS as documented on Vergilius Project:
volatile ULONGLONG OwnerProcessId;
struct _PEB* Peb;
struct _MM_SESSION_SPACE* Session;
VOID* Sparel;
In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like dt nt!_EPROCESS in windbg and get a peek at the layout. We&rsquo;ll have to enable kernel debugging to more closely examine things. But here&rsquo;s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hexagram.foo/posts/"},{"@type":"ListItem","position":2,"name":"Finding Active Processes with Windbg","item":"https://hexagram.foo/posts/finding-active-processes-with-windbg/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Finding Active Processes with Windbg","name":"Finding Active Processes with Windbg","description":"In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure. A snippet from _EPROCESS as documented on Vergilius Project:\nvolatile ULONGLONG OwnerProcessId; struct _PEB* Peb; struct _MM_SESSION_SPACE* Session; VOID* Sparel; In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like dt nt!_EPROCESS in windbg and get a peek at the layout. We\u0026rsquo;ll have to enable kernel debugging to more closely examine things. But here\u0026rsquo;s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:\n","keywords":["windows","windbg"],"articleBody":"In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure. A snippet from _EPROCESS as documented on Vergilius Project:\nvolatile ULONGLONG OwnerProcessId; struct _PEB* Peb; struct _MM_SESSION_SPACE* Session; VOID* Sparel; In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like dt nt!_EPROCESS in windbg and get a peek at the layout. We’ll have to enable kernel debugging to more closely examine things. But here’s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:\n\u003e dt nt!_EPROCESS ntdll!_EPROCESS +0x000 Pcb : _KPROCESS +0x438 ProcessLock : _EX_PUSH_LOCK +0x440 UniqueProcessId : Ptr64 Void +0x448 ActiveProcessLinks : _LIST_ENTRY +0x458 RundownProtect : _EX_RUNDOWN_REF +0x460 Flags2 : Uint4B +0x460 JobNotReallyActive : Pos 0, 1 Bit +0x460 AccountingFolded : Pos 1, 1 Bit +0x460 NewProcessReported : Pos 2, 1 Bit +0x460 ExitProcessReported : Pos 3, 1 Bit +0x460 ReportCommitChanges : Pos 4, 1 Bit +0x460 LastReportMemory : Pos 5, 1 Bit +0x460 ForceWakeCharge : Pos 6, 1 Bit +0x460 CrossSessionCreate : Pos 7, 1 Bit +0x460 NeedsHandleRundown : Pos 8, 1 Bit +0x460 RefTraceEnabled : Pos 9, 1 Bit +0x460 PicoCreated : Pos 10, 1 Bit +0x460 EmptyJobEvaluated : Pos 11, 1 Bit +0x460 DefaultPagePriority : Pos 12, 3 Bits +0x460 PrimaryTokenFrozen : Pos 15, 1 Bit +0x460 ProcessVerifierTarget : Pos 16, 1 Bit +0x460 RestrictSetThreadContext : Pos 17, 1 Bit +0x460 AffinityPermanent : Pos 18, 1 Bit +0x460 AffinityUpdateEnable : Pos 19, 1 Bit +0x460 PropagateNode : Pos 20, 1 Bit +0x460 ExplicitAffinity : Pos 21, 1 Bit +0x460 ProcessExecutionState : Pos 22, 2 Bits +0x460 EnableReadVmLogging : Pos 24, 1 Bit +0x460 EnableWriteVmLogging : Pos 25, 1 Bit +0x460 FatalAccessTerminationRequested : Pos 26, 1 Bit +0x460 DisableSystemAllowedCpuSet : Pos 27, 1 Bit +0x460 ProcessStateChangeRequest : Pos 28, 2 Bits +0x460 ProcessStateChangeInProgress : Pos 30, 1 Bit +0x460 InPrivate : Pos 31, 1 Bit +0x464 Flags : Uint4B +0x464 CreateReported : Pos 0, 1 Bit +0x464 NoDebugInherit : Pos 1, 1 Bit +0x464 ProcessExiting : Pos 2, 1 Bit +0x464 ProcessDelete : Pos 3, 1 Bit +0x464 ManageExecutableMemoryWrites : Pos 4, 1 Bit +0x464 VmDeleted : Pos 5, 1 Bit +0x464 OutswapEnabled : Pos 6, 1 Bit +0x464 Outswapped : Pos 7, 1 Bit +0x464 FailFastOnCommitFail : Pos 8, 1 Bit +0x464 Wow64VaSpace4Gb : Pos 9, 1 Bit +0x464 AddressSpaceInitialized : Pos 10, 2 Bits +0x464 SetTimerResolution : Pos 12, 1 Bit +0x464 BreakOnTermination : Pos 13, 1 Bit +0x464 DeprioritizeViews : Pos 14, 1 Bit +0x464 WriteWatch : Pos 15, 1 Bit +0x464 ProcessInSession : Pos 16, 1 Bit +0x464 OverrideAddressSpace : Pos 17, 1 Bit +0x464 HasAddressSpace : Pos 18, 1 Bit +0x464 LaunchPrefetched : Pos 19, 1 Bit +0x464 Reserved : Pos 20, 1 Bit +0x464 VmTopDown : Pos 21, 1 Bit +0x464 ImageNotifyDone : Pos 22, 1 Bit +0x464 PdeUpdateNeeded : Pos 23, 1 Bit +0x464 VdmAllowed : Pos 24, 1 Bit +0x464 ProcessRundown : Pos 25, 1 Bit +0x464 ProcessInserted : Pos 26, 1 Bit +0x464 DefaultIoPriority : Pos 27, 3 Bits +0x464 ProcessSelfDelete : Pos 30, 1 Bit +0x464 SetTimerResolutionLink : Pos 31, 1 Bit +0x468 CreateTime : _LARGE_INTEGER +0x470 ProcessQuotaUsage : [2] Uint8B +0x480 ProcessQuotaPeak : [2] Uint8B +0x490 PeakVirtualSize : Uint8B +0x498 VirtualSize : Uint8B +0x4a0 SessionProcessLinks : _LIST_ENTRY +0x4b0 ExceptionPortData : Ptr64 Void +0x4b0 ExceptionPortValue : Uint8B +0x4b0 ExceptionPortState : Pos 0, 3 Bits +0x4b8 Token : _EX_FAST_REF +0x4c0 MmReserved : Uint8B +0x4c8 AddressCreationLock : _EX_PUSH_LOCK +0x4d0 PageTableCommitmentLock : _EX_PUSH_LOCK +0x4d8 RotateInProgress : Ptr64 _ETHREAD +0x4e0 ForkInProgress : Ptr64 _ETHREAD +0x4e8 CommitChargeJob : Ptr64 _EJOB +0x4f0 CloneRoot : _RTL_AVL_TREE +0x4f8 NumberOfPrivatePages : Uint8B +0x500 NumberOfLockedPages : Uint8B +0x508 Win32Process : Ptr64 Void +0x510 Job : Ptr64 _EJOB +0x518 SectionObject : Ptr64 Void +0x520 SectionBaseAddress : Ptr64 Void +0x528 Cookie : Uint4B +0x530 WorkingSetWatch : Ptr64 _PAGEFAULT_HISTORY +0x538 Win32WindowStation : Ptr64 Void +0x540 InheritedFromUniqueProcessId : Ptr64 Void +0x548 OwnerProcessId : Uint8B +0x550 Peb : Ptr64 _PEB +0x558 Session : Ptr64 _MM_SESSION_SPACE +0x560 Spare1 : Ptr64 Void +0x568 QuotaBlock : Ptr64 _EPROCESS_QUOTA_BLOCK +0x570 ObjectTable : Ptr64 _HANDLE_TABLE +0x578 DebugPort : Ptr64 Void +0x580 WoW64Process : Ptr64 _EWOW64PROCESS +0x588 DeviceMap : _EX_FAST_REF +0x590 EtwDataSource : Ptr64 Void +0x598 PageDirectoryPte : Uint8B +0x5a0 ImageFilePointer : Ptr64 _FILE_OBJECT +0x5a8 ImageFileName : [15] UChar +0x5b7 PriorityClass : UChar +0x5b8 SecurityPort : Ptr64 Void +0x5c0 SeAuditProcessCreationInfo : _SE_AUDIT_PROCESS_CREATION_INFO +0x5c8 JobLinks : _LIST_ENTRY +0x5d8 HighestUserAddress : Ptr64 Void +0x5e0 ThreadListHead : _LIST_ENTRY +0x5f0 ActiveThreads : Uint4B +0x5f4 ImagePathHash : Uint4B +0x5f8 DefaultHardErrorProcessing : Uint4B +0x5fc LastThreadExitStatus : Int4B +0x600 PrefetchTrace : _EX_FAST_REF +0x608 LockedPagesList : Ptr64 Void +0x610 ReadOperationCount : _LARGE_INTEGER +0x618 WriteOperationCount : _LARGE_INTEGER +0x620 OtherOperationCount : _LARGE_INTEGER +0x628 ReadTransferCount : _LARGE_INTEGER +0x630 WriteTransferCount : _LARGE_INTEGER +0x638 OtherTransferCount : _LARGE_INTEGER +0x640 CommitChargeLimit : Uint8B +0x648 CommitCharge : Uint8B +0x650 CommitChargePeak : Uint8B +0x680 Vm : _MMSUPPORT_FULL +0x7c0 MmProcessLinks : _LIST_ENTRY +0x7d0 ModifiedPageCount : Uint4B +0x7d4 ExitStatus : Int4B +0x7d8 VadRoot : _RTL_AVL_TREE +0x7e0 VadHint : Ptr64 Void +0x7e8 VadCount : Uint8B +0x7f0 VadPhysicalPages : Uint8B +0x7f8 VadPhysicalPagesLimit : Uint8B +0x800 AlpcContext : _ALPC_PROCESS_CONTEXT +0x820 TimerResolutionLink : _LIST_ENTRY +0x830 TimerResolutionStackRecord : Ptr64 _PO_DIAG_STACK_RECORD +0x838 RequestedTimerResolution : Uint4B +0x83c SmallestTimerResolution : Uint4B +0x840 ExitTime : _LARGE_INTEGER +0x848 InvertedFunctionTable : Ptr64 _INVERTED_FUNCTION_TABLE_USER_MODE +0x850 InvertedFunctionTableLock : _EX_PUSH_LOCK +0x858 ActiveThreadsHighWatermark : Uint4B +0x85c LargePrivateVadCount : Uint4B +0x860 ThreadListLock : _EX_PUSH_LOCK +0x868 WnfContext : Ptr64 Void +0x870 ServerSilo : Ptr64 _EJOB +0x878 SignatureLevel : UChar +0x879 SectionSignatureLevel : UChar +0x87a Protection : _PS_PROTECTION +0x87b HangCount : Pos 0, 3 Bits +0x87b GhostCount : Pos 3, 3 Bits +0x87b PrefilterException : Pos 6, 1 Bit +0x87c Flags3 : Uint4B +0x87c Minimal : Pos 0, 1 Bit +0x87c ReplacingPageRoot : Pos 1, 1 Bit +0x87c Crashed : Pos 2, 1 Bit +0x87c JobVadsAreTracked : Pos 3, 1 Bit +0x87c VadTrackingDisabled : Pos 4, 1 Bit +0x87c AuxiliaryProcess : Pos 5, 1 Bit +0x87c SubsystemProcess : Pos 6, 1 Bit +0x87c IndirectCpuSets : Pos 7, 1 Bit +0x87c RelinquishedCommit : Pos 8, 1 Bit +0x87c HighGraphicsPriority : Pos 9, 1 Bit +0x87c CommitFailLogged : Pos 10, 1 Bit +0x87c ReserveFailLogged : Pos 11, 1 Bit +0x87c SystemProcess : Pos 12, 1 Bit +0x87c HideImageBaseAddresses : Pos 13, 1 Bit +0x87c AddressPolicyFrozen : Pos 14, 1 Bit +0x87c ProcessFirstResume : Pos 15, 1 Bit +0x87c ForegroundExternal : Pos 16, 1 Bit +0x87c ForegroundSystem : Pos 17, 1 Bit +0x87c HighMemoryPriority : Pos 18, 1 Bit +0x87c EnableProcessSuspendResumeLogging : Pos 19, 1 Bit +0x87c EnableThreadSuspendResumeLogging : Pos 20, 1 Bit +0x87c SecurityDomainChanged : Pos 21, 1 Bit +0x87c SecurityFreezeComplete : Pos 22, 1 Bit +0x87c VmProcessorHost : Pos 23, 1 Bit +0x87c VmProcessorHostTransition : Pos 24, 1 Bit +0x87c AltSyscall : Pos 25, 1 Bit +0x87c TimerResolutionIgnore : Pos 26, 1 Bit +0x87c DisallowUserTerminate : Pos 27, 1 Bit +0x87c EnableProcessRemoteExecProtectVmLogging : Pos 28, 1 Bit +0x87c EnableProcessLocalExecProtectVmLogging : Pos 29, 1 Bit +0x87c MemoryCompressionProcess : Pos 30, 1 Bit +0x880 DeviceAsid : Int4B +0x888 SvmData : Ptr64 Void +0x890 SvmProcessLock : _EX_PUSH_LOCK +0x898 SvmLock : Uint8B +0x8a0 SvmProcessDeviceListHead : _LIST_ENTRY +0x8b0 LastFreezeInterruptTime : Uint8B +0x8b8 DiskCounters : Ptr64 _PROCESS_DISK_COUNTERS +0x8c0 PicoContext : Ptr64 Void +0x8c8 EnclaveTable : Ptr64 Void +0x8d0 EnclaveNumber : Uint8B +0x8d8 EnclaveLock : _EX_PUSH_LOCK +0x8e0 HighPriorityFaultsAllowed : Uint4B +0x8e8 EnergyContext : Ptr64 _PO_PROCESS_ENERGY_CONTEXT +0x8f0 VmContext : Ptr64 Void +0x8f8 SequenceNumber : Uint8B +0x900 CreateInterruptTime : Uint8B +0x908 CreateUnbiasedInterruptTime : Uint8B +0x910 TotalUnbiasedFrozenTime : Uint8B +0x918 LastAppStateUpdateTime : Uint8B +0x920 LastAppStateUptime : Pos 0, 61 Bits +0x920 LastAppState : Pos 61, 3 Bits +0x928 SharedCommitCharge : Uint8B +0x930 SharedCommitLock : _EX_PUSH_LOCK +0x938 SharedCommitLinks : _LIST_ENTRY +0x948 AllowedCpuSets : Uint8B +0x950 DefaultCpuSets : Uint8B +0x948 AllowedCpuSetsIndirect : Ptr64 Uint8B +0x950 DefaultCpuSetsIndirect : Ptr64 Uint8B +0x958 DiskIoAttribution : Ptr64 Void +0x960 DxgProcess : Ptr64 Void +0x968 Win32KFilterSet : Uint4B +0x96c Machine : Uint2B +0x96e Spare0 : Uint2B +0x970 ProcessTimerDelay : _PS_INTERLOCKED_TIMER_DELAY_VALUES +0x978 KTimerSets : Uint4B +0x97c KTimer2Sets : Uint4B +0x980 ThreadTimerSets : Uint4B +0x988 VirtualTimerListLock : Uint8B +0x990 VirtualTimerListHead : _LIST_ENTRY +0x9a0 WakeChannel : _WNF_STATE_NAME +0x9a0 WakeInfo : _PS_PROCESS_WAKE_INFORMATION +0x9d0 MitigationFlags : Uint4B +0x9d0 MitigationFlagsValues : +0x9d4 MitigationFlags2 : Uint4B +0x9d4 MitigationFlags2Values : +0x9d8 PartitionObject : Ptr64 Void +0x9e0 SecurityDomain : Uint8B +0x9e8 ParentSecurityDomain : Uint8B +0x9f0 CoverageSamplerContext : Ptr64 Void +0x9f8 MmHotPatchContext : Ptr64 Void +0xa00 IdealProcessorAssignmentBlock : _KE_IDEAL_PROCESSOR_ASSIGNMENT_BLOCK +0xb18 DynamicEHContinuationTargetsTree : _RTL_AVL_TREE +0xb20 DynamicEHContinuationTargetsLock : _EX_PUSH_LOCK +0xb28 DynamicEnforcedCetCompatibleRanges : _PS_DYNAMIC_ENFORCED_ADDRESS_RANGES +0xb38 DisabledComponentFlags : Uint4B +0xb3c PageCombineSequence : Int4B +0xb40 EnableOptionalXStateFeaturesLock : _EX_PUSH_LOCK +0xb48 PathRedirectionHashes : Ptr64 Uint4B +0xb50 SyscallProviderReserved : [4] Ptr64 Void +0xb70 MitigationFlags3 : Uint4B +0xb70 MitigationFlags3Values : I won’t cover all of these entries here. But observe that near the top of the structure, we see an entry called ActiveProcessLinks, which is part of a doubly linked-list, containing forward and backwards pointers linking entries together. This EPROCESS list structure contains all the active programs. And if we enable kernel debugging, we can iterate through this list.\nIn an elevated Command Prompt, we run bcdedit -debug on and reboot the machine. And then open windbg with administrative privileges.\nIn a local kernel debug session, we can now check the PsActiveProcessHead structure and get it’s address. This is the structure that the Microsoft utility PsList walks to produce a list of active processes.\nlkd\u003e x nt!PsActiveProcessHead fffff807`25e37f90 nt!PsActiveProcessHead = Next let’s get the _LIST_ENTRY forward link (Flink) using the address from the PsActiveProcessHead structure:\nlkd\u003e dt nt!_LIST_ENTRY fffff807`25e37f90 [ 0xffffc509`c5488488 - 0xffffc509`cc9d6508 ] +0x000 Flink : 0xffffc509`c5488488 _LIST_ENTRY [ 0xffffc509`c54f64c8 - 0xfffff807`25e37f90 ] +0x008 Blink : 0xffffc509`cc9d6508 _LIST_ENTRY [ 0xfffff807`25e37f90 - 0xffffc509`cbf98508 ] The second thing we need is the offset of the EPROCESS structure’s ActiveProcessLinks _LIST_ENTRY, which we can see here at 0x448:\nlkd\u003e dt nt!_eprocess +0x000 Pcb : _KPROCESS +0x438 ProcessLock : _EX_PUSH_LOCK +0x440 UniqueProcessId : Ptr64 Void +0x448 ActiveProcessLinks : _LIST_ENTRY And now that we have the Flink _LIST_ENTRY address 0xffffc509`c5488488 — bringing it all together, we can get the first entry (first foward link, or flink) to the ActiveProcessLinks list, and thus the ImageFileName of the first record in the EPROCESS list. We’ll use the LIST_ENTRY address and subtract the offset of the ActiveProcessLinks value (0x448).\nWhat we’re doing here essentially is using the offset to locate the beginning of each EPROCESS record. Knowing this, we then tell the debugger we want get both the ActiveProcessLinks.flink, the forward link to the next entry in the linked list, and the ImageFileName of the current entry:\nlkd\u003e dt nt!_eprocess 0xffffc509`c5488488-0x448 -y ActiveProcessLinks.flink -y ImageFileName +0x448 ActiveProcessLinks : [ 0xffffc509`c54f64c8 - 0xfffff807`25e37f90 ] +0x000 Flink : 0xffffc509`c54f64c8 _LIST_ENTRY [ 0xffffc509`c8373488 - 0xffffc509`c5488488 ] +0x5a8 ImageFileName : [15] \"System\" Ah, the System image file name. And we see the next flink that is referenced is 0xffffc509`c54f64c8. Let’s get the ImageFileName for that entry, too:\nlkd\u003e dt nt!_eprocess 0xffffc509`c54f64c8-0x448 -y ActiveProcessLinks.flink -y ImageFileName +0x448 ActiveProcessLinks : [ 0xffffc509`c8373488 - 0xffffc509`c5488488 ] +0x000 Flink : 0xffffc509`c8373488 _LIST_ENTRY [ 0xffffc509`c8194508 - 0xffffc509`c54f64c8 ] +0x5a8 ImageFileName : [15] \"Registry\" The Registry service! Alright. And once more we see the next address is at 0xffffc509`c8373488. We’ll get the ImageFileName for that entry as well:\nlkd\u003e dt nt!_eprocess 0xffffc509`c8373488-0x448 -y ActiveProcessLinks.flink -y ImageFileName +0x448 ActiveProcessLinks : [ 0xffffc509`c8194508 - 0xffffc509`c54f64c8 ] +0x000 Flink : 0xffffc509`c8194508 _LIST_ENTRY [ 0xffffc509`ca6794c8 - 0xffffc509`c8373488 ] +0x5a8 ImageFileName : [15] \"smss.exe\" And that’s the smss.exe executable, which provides functionality for Microsoft Window’s Session Manager Subsystem.\nWe could continue walking the EPROCESS list and enumerate every processes forward and backwards pointers. But I won’t iterate through all of them manually here.\nThe kernel debugger in Windows also provides some nice built-in functionality to make looping through process structures pretty fast. We can use the !process module in the kernel debugger to get information about active processes, like so:\nlkd\u003e !process 0 0 **** NT ACTIVE PROCESS DUMP **** PROCESS ffffc509c5488040 SessionId: none Cid: 0004 Peb: 00000000 ParentCid: 0000 DirBase: 001ae002 ObjectTable: ffffda878c2aae80 HandleCount: 2748. Image: System PROCESS ffffc509c54f6080 SessionId: none Cid: 006c Peb: 00000000 ParentCid: 0004 DirBase: 1031d5002 ObjectTable: ffffda878c259cc0 HandleCount: 0. Image: Registry PROCESS ffffc509c8373040 SessionId: none Cid: 01c0 Peb: 5d58682000 ParentCid: 0004 DirBase: 10dcb5002 ObjectTable: ffffda878d5909c0 HandleCount: 58. Image: smss.exe ... We can verify our work here. The expression 0xffffc509`c5488488 - `0x448 evaluates to 0xffffc509c5488040. So, we know our System value is correct.\nBut what about our Registry value? Well, 0xffffc509`c54f64c8 - 0x448 gives us 0xffffc509c54f6080. So our Registry value is also correct.\nAnd our entry for smss.exe appears to be on accurate as well. Verifying it against the kernel debugger’s !process module output, it correctly evaluates to 0xffffc509c8373040, which is the result of the offset subtraction we did prior: 0xffffc509`c8373488 - 0x448.\nWe can use a simple Python script to double check that the offsets we calculated beforehand align with those printed out by the !process module:\noffset = 0x448 memory_addresses = [ 0xffffc509c5488488, 0xffffc509c54f64c8, 0xffffc509c8373488 ] for address in memory_addresses: result = address - offset print(hex(result)) 0xffffc509c5488040 0xffffc509c54f6080 0xffffc509c8373040 ","wordCount":"2170","inLanguage":"en","image":"https://hexagram.foo/fog.jpeg","datePublished":"2023-09-02T00:00:00Z","dateModified":"2023-09-02T00:00:00Z","author":{"@type":"Person","name":"Stephan Bridger"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hexagram.foo/posts/finding-active-processes-with-windbg/"},"publisher":{"@type":"Organization","name":"Stephan Bridger","logo":{"@type":"ImageObject","url":"https://hexagram.foo/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hexagram.foo/ accesskey=h title="Stephan Bridger (Alt + H)">Stephan Bridger</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hexagram.foo/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://hexagram.foo/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hexagram.foo/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://hexagram.foo/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Finding Active Processes with Windbg</h1><div class=post-meta><span title='2023-09-02 00:00:00 +0000 UTC'>September 2, 2023</span>&nbsp;·&nbsp;<span>11 min</span>&nbsp;·&nbsp;<span>2170 words</span>&nbsp;·&nbsp;<span>Stephan Bridger</span></div></header><div class=post-content><p>In the Windows kernel, each process is assigned an EPROCESS structure, which is a kernel object that represents a program or process. And a Process Environment Block (PEB) is just one of many structures pointed to by the EPROCESS structure. A snippet from <code>_EPROCESS</code> as documented on Vergilius Project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>volatile</span> <span class=n>ULONGLONG</span> <span class=n>OwnerProcessId</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>_PEB</span><span class=o>*</span> <span class=n>Peb</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>_MM_SESSION_SPACE</span><span class=o>*</span> <span class=n>Session</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>VOID</span><span class=o>*</span> <span class=n>Sparel</span><span class=p>;</span>
</span></span></code></pre></div><p>In user space however, we cannot directly reference all of the EPROCESS structures and their data. At most, we can do something like <code>dt nt!_EPROCESS</code> in windbg and get a peek at the layout. We&rsquo;ll have to enable kernel debugging to more closely examine things. But here&rsquo;s what we can see in user mode. The EPROCESS structure is large. The entire output from windbg is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&gt; dt nt!_EPROCESS
</span></span><span class=line><span class=cl>ntdll!_EPROCESS
</span></span><span class=line><span class=cl>   +0x000 Pcb              : _KPROCESS
</span></span><span class=line><span class=cl>   +0x438 ProcessLock      : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x440 UniqueProcessId  : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x448 ActiveProcessLinks : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x458 RundownProtect   : _EX_RUNDOWN_REF
</span></span><span class=line><span class=cl>   +0x460 Flags2           : Uint4B
</span></span><span class=line><span class=cl>   +0x460 JobNotReallyActive : Pos 0, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 AccountingFolded : Pos 1, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 NewProcessReported : Pos 2, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ExitProcessReported : Pos 3, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ReportCommitChanges : Pos 4, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 LastReportMemory : Pos 5, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ForceWakeCharge  : Pos 6, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 CrossSessionCreate : Pos 7, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 NeedsHandleRundown : Pos 8, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 RefTraceEnabled  : Pos 9, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 PicoCreated      : Pos 10, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 EmptyJobEvaluated : Pos 11, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 DefaultPagePriority : Pos 12, 3 Bits
</span></span><span class=line><span class=cl>   +0x460 PrimaryTokenFrozen : Pos 15, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ProcessVerifierTarget : Pos 16, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 RestrictSetThreadContext : Pos 17, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 AffinityPermanent : Pos 18, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 AffinityUpdateEnable : Pos 19, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 PropagateNode    : Pos 20, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ExplicitAffinity : Pos 21, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ProcessExecutionState : Pos 22, 2 Bits
</span></span><span class=line><span class=cl>   +0x460 EnableReadVmLogging : Pos 24, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 EnableWriteVmLogging : Pos 25, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 FatalAccessTerminationRequested : Pos 26, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 DisableSystemAllowedCpuSet : Pos 27, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 ProcessStateChangeRequest : Pos 28, 2 Bits
</span></span><span class=line><span class=cl>   +0x460 ProcessStateChangeInProgress : Pos 30, 1 Bit
</span></span><span class=line><span class=cl>   +0x460 InPrivate        : Pos 31, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 Flags            : Uint4B
</span></span><span class=line><span class=cl>   +0x464 CreateReported   : Pos 0, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 NoDebugInherit   : Pos 1, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ProcessExiting   : Pos 2, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ProcessDelete    : Pos 3, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ManageExecutableMemoryWrites : Pos 4, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 VmDeleted        : Pos 5, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 OutswapEnabled   : Pos 6, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 Outswapped       : Pos 7, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 FailFastOnCommitFail : Pos 8, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 Wow64VaSpace4Gb  : Pos 9, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 AddressSpaceInitialized : Pos 10, 2 Bits
</span></span><span class=line><span class=cl>   +0x464 SetTimerResolution : Pos 12, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 BreakOnTermination : Pos 13, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 DeprioritizeViews : Pos 14, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 WriteWatch       : Pos 15, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ProcessInSession : Pos 16, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 OverrideAddressSpace : Pos 17, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 HasAddressSpace  : Pos 18, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 LaunchPrefetched : Pos 19, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 Reserved         : Pos 20, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 VmTopDown        : Pos 21, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ImageNotifyDone  : Pos 22, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 PdeUpdateNeeded  : Pos 23, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 VdmAllowed       : Pos 24, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ProcessRundown   : Pos 25, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 ProcessInserted  : Pos 26, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 DefaultIoPriority : Pos 27, 3 Bits
</span></span><span class=line><span class=cl>   +0x464 ProcessSelfDelete : Pos 30, 1 Bit
</span></span><span class=line><span class=cl>   +0x464 SetTimerResolutionLink : Pos 31, 1 Bit
</span></span><span class=line><span class=cl>   +0x468 CreateTime       : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x470 ProcessQuotaUsage : [2] Uint8B
</span></span><span class=line><span class=cl>   +0x480 ProcessQuotaPeak : [2] Uint8B
</span></span><span class=line><span class=cl>   +0x490 PeakVirtualSize  : Uint8B
</span></span><span class=line><span class=cl>   +0x498 VirtualSize      : Uint8B
</span></span><span class=line><span class=cl>   +0x4a0 SessionProcessLinks : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x4b0 ExceptionPortData : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x4b0 ExceptionPortValue : Uint8B
</span></span><span class=line><span class=cl>   +0x4b0 ExceptionPortState : Pos 0, 3 Bits
</span></span><span class=line><span class=cl>   +0x4b8 Token            : _EX_FAST_REF
</span></span><span class=line><span class=cl>   +0x4c0 MmReserved       : Uint8B
</span></span><span class=line><span class=cl>   +0x4c8 AddressCreationLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x4d0 PageTableCommitmentLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x4d8 RotateInProgress : Ptr64 _ETHREAD
</span></span><span class=line><span class=cl>   +0x4e0 ForkInProgress   : Ptr64 _ETHREAD
</span></span><span class=line><span class=cl>   +0x4e8 CommitChargeJob  : Ptr64 _EJOB
</span></span><span class=line><span class=cl>   +0x4f0 CloneRoot        : _RTL_AVL_TREE
</span></span><span class=line><span class=cl>   +0x4f8 NumberOfPrivatePages : Uint8B
</span></span><span class=line><span class=cl>   +0x500 NumberOfLockedPages : Uint8B
</span></span><span class=line><span class=cl>   +0x508 Win32Process     : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x510 Job              : Ptr64 _EJOB
</span></span><span class=line><span class=cl>   +0x518 SectionObject    : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x520 SectionBaseAddress : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x528 Cookie           : Uint4B
</span></span><span class=line><span class=cl>   +0x530 WorkingSetWatch  : Ptr64 _PAGEFAULT_HISTORY
</span></span><span class=line><span class=cl>   +0x538 Win32WindowStation : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x540 InheritedFromUniqueProcessId : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x548 OwnerProcessId   : Uint8B
</span></span><span class=line><span class=cl>   +0x550 Peb              : Ptr64 _PEB
</span></span><span class=line><span class=cl>   +0x558 Session          : Ptr64 _MM_SESSION_SPACE
</span></span><span class=line><span class=cl>   +0x560 Spare1           : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x568 QuotaBlock       : Ptr64 _EPROCESS_QUOTA_BLOCK
</span></span><span class=line><span class=cl>   +0x570 ObjectTable      : Ptr64 _HANDLE_TABLE
</span></span><span class=line><span class=cl>   +0x578 DebugPort        : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x580 WoW64Process     : Ptr64 _EWOW64PROCESS
</span></span><span class=line><span class=cl>   +0x588 DeviceMap        : _EX_FAST_REF
</span></span><span class=line><span class=cl>   +0x590 EtwDataSource    : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x598 PageDirectoryPte : Uint8B
</span></span><span class=line><span class=cl>   +0x5a0 ImageFilePointer : Ptr64 _FILE_OBJECT
</span></span><span class=line><span class=cl>   +0x5a8 ImageFileName    : [15] UChar
</span></span><span class=line><span class=cl>   +0x5b7 PriorityClass    : UChar
</span></span><span class=line><span class=cl>   +0x5b8 SecurityPort     : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x5c0 SeAuditProcessCreationInfo : _SE_AUDIT_PROCESS_CREATION_INFO
</span></span><span class=line><span class=cl>   +0x5c8 JobLinks         : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x5d8 HighestUserAddress : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x5e0 ThreadListHead   : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x5f0 ActiveThreads    : Uint4B
</span></span><span class=line><span class=cl>   +0x5f4 ImagePathHash    : Uint4B
</span></span><span class=line><span class=cl>   +0x5f8 DefaultHardErrorProcessing : Uint4B
</span></span><span class=line><span class=cl>   +0x5fc LastThreadExitStatus : Int4B
</span></span><span class=line><span class=cl>   +0x600 PrefetchTrace    : _EX_FAST_REF
</span></span><span class=line><span class=cl>   +0x608 LockedPagesList  : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x610 ReadOperationCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x618 WriteOperationCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x620 OtherOperationCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x628 ReadTransferCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x630 WriteTransferCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x638 OtherTransferCount : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x640 CommitChargeLimit : Uint8B
</span></span><span class=line><span class=cl>   +0x648 CommitCharge     : Uint8B
</span></span><span class=line><span class=cl>   +0x650 CommitChargePeak : Uint8B
</span></span><span class=line><span class=cl>   +0x680 Vm               : _MMSUPPORT_FULL
</span></span><span class=line><span class=cl>   +0x7c0 MmProcessLinks   : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x7d0 ModifiedPageCount : Uint4B
</span></span><span class=line><span class=cl>   +0x7d4 ExitStatus       : Int4B
</span></span><span class=line><span class=cl>   +0x7d8 VadRoot          : _RTL_AVL_TREE
</span></span><span class=line><span class=cl>   +0x7e0 VadHint          : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x7e8 VadCount         : Uint8B
</span></span><span class=line><span class=cl>   +0x7f0 VadPhysicalPages : Uint8B
</span></span><span class=line><span class=cl>   +0x7f8 VadPhysicalPagesLimit : Uint8B
</span></span><span class=line><span class=cl>   +0x800 AlpcContext      : _ALPC_PROCESS_CONTEXT
</span></span><span class=line><span class=cl>   +0x820 TimerResolutionLink : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x830 TimerResolutionStackRecord : Ptr64 _PO_DIAG_STACK_RECORD
</span></span><span class=line><span class=cl>   +0x838 RequestedTimerResolution : Uint4B
</span></span><span class=line><span class=cl>   +0x83c SmallestTimerResolution : Uint4B
</span></span><span class=line><span class=cl>   +0x840 ExitTime         : _LARGE_INTEGER
</span></span><span class=line><span class=cl>   +0x848 InvertedFunctionTable : Ptr64 _INVERTED_FUNCTION_TABLE_USER_MODE
</span></span><span class=line><span class=cl>   +0x850 InvertedFunctionTableLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x858 ActiveThreadsHighWatermark : Uint4B
</span></span><span class=line><span class=cl>   +0x85c LargePrivateVadCount : Uint4B
</span></span><span class=line><span class=cl>   +0x860 ThreadListLock   : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x868 WnfContext       : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x870 ServerSilo       : Ptr64 _EJOB
</span></span><span class=line><span class=cl>   +0x878 SignatureLevel   : UChar
</span></span><span class=line><span class=cl>   +0x879 SectionSignatureLevel : UChar
</span></span><span class=line><span class=cl>   +0x87a Protection       : _PS_PROTECTION
</span></span><span class=line><span class=cl>   +0x87b HangCount        : Pos 0, 3 Bits
</span></span><span class=line><span class=cl>   +0x87b GhostCount       : Pos 3, 3 Bits
</span></span><span class=line><span class=cl>   +0x87b PrefilterException : Pos 6, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c Flags3           : Uint4B
</span></span><span class=line><span class=cl>   +0x87c Minimal          : Pos 0, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c ReplacingPageRoot : Pos 1, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c Crashed          : Pos 2, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c JobVadsAreTracked : Pos 3, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c VadTrackingDisabled : Pos 4, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c AuxiliaryProcess : Pos 5, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c SubsystemProcess : Pos 6, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c IndirectCpuSets  : Pos 7, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c RelinquishedCommit : Pos 8, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c HighGraphicsPriority : Pos 9, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c CommitFailLogged : Pos 10, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c ReserveFailLogged : Pos 11, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c SystemProcess    : Pos 12, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c HideImageBaseAddresses : Pos 13, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c AddressPolicyFrozen : Pos 14, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c ProcessFirstResume : Pos 15, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c ForegroundExternal : Pos 16, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c ForegroundSystem : Pos 17, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c HighMemoryPriority : Pos 18, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c EnableProcessSuspendResumeLogging : Pos 19, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c EnableThreadSuspendResumeLogging : Pos 20, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c SecurityDomainChanged : Pos 21, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c SecurityFreezeComplete : Pos 22, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c VmProcessorHost  : Pos 23, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c VmProcessorHostTransition : Pos 24, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c AltSyscall       : Pos 25, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c TimerResolutionIgnore : Pos 26, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c DisallowUserTerminate : Pos 27, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c EnableProcessRemoteExecProtectVmLogging : Pos 28, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c EnableProcessLocalExecProtectVmLogging : Pos 29, 1 Bit
</span></span><span class=line><span class=cl>   +0x87c MemoryCompressionProcess : Pos 30, 1 Bit
</span></span><span class=line><span class=cl>   +0x880 DeviceAsid       : Int4B
</span></span><span class=line><span class=cl>   +0x888 SvmData          : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x890 SvmProcessLock   : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x898 SvmLock          : Uint8B
</span></span><span class=line><span class=cl>   +0x8a0 SvmProcessDeviceListHead : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x8b0 LastFreezeInterruptTime : Uint8B
</span></span><span class=line><span class=cl>   +0x8b8 DiskCounters     : Ptr64 _PROCESS_DISK_COUNTERS
</span></span><span class=line><span class=cl>   +0x8c0 PicoContext      : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x8c8 EnclaveTable     : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x8d0 EnclaveNumber    : Uint8B
</span></span><span class=line><span class=cl>   +0x8d8 EnclaveLock      : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x8e0 HighPriorityFaultsAllowed : Uint4B
</span></span><span class=line><span class=cl>   +0x8e8 EnergyContext    : Ptr64 _PO_PROCESS_ENERGY_CONTEXT
</span></span><span class=line><span class=cl>   +0x8f0 VmContext        : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x8f8 SequenceNumber   : Uint8B
</span></span><span class=line><span class=cl>   +0x900 CreateInterruptTime : Uint8B
</span></span><span class=line><span class=cl>   +0x908 CreateUnbiasedInterruptTime : Uint8B
</span></span><span class=line><span class=cl>   +0x910 TotalUnbiasedFrozenTime : Uint8B
</span></span><span class=line><span class=cl>   +0x918 LastAppStateUpdateTime : Uint8B
</span></span><span class=line><span class=cl>   +0x920 LastAppStateUptime : Pos 0, 61 Bits
</span></span><span class=line><span class=cl>   +0x920 LastAppState     : Pos 61, 3 Bits
</span></span><span class=line><span class=cl>   +0x928 SharedCommitCharge : Uint8B
</span></span><span class=line><span class=cl>   +0x930 SharedCommitLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x938 SharedCommitLinks : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x948 AllowedCpuSets   : Uint8B
</span></span><span class=line><span class=cl>   +0x950 DefaultCpuSets   : Uint8B
</span></span><span class=line><span class=cl>   +0x948 AllowedCpuSetsIndirect : Ptr64 Uint8B
</span></span><span class=line><span class=cl>   +0x950 DefaultCpuSetsIndirect : Ptr64 Uint8B
</span></span><span class=line><span class=cl>   +0x958 DiskIoAttribution : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x960 DxgProcess       : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x968 Win32KFilterSet  : Uint4B
</span></span><span class=line><span class=cl>   +0x96c Machine          : Uint2B
</span></span><span class=line><span class=cl>   +0x96e Spare0           : Uint2B
</span></span><span class=line><span class=cl>   +0x970 ProcessTimerDelay : _PS_INTERLOCKED_TIMER_DELAY_VALUES
</span></span><span class=line><span class=cl>   +0x978 KTimerSets       : Uint4B
</span></span><span class=line><span class=cl>   +0x97c KTimer2Sets      : Uint4B
</span></span><span class=line><span class=cl>   +0x980 ThreadTimerSets  : Uint4B
</span></span><span class=line><span class=cl>   +0x988 VirtualTimerListLock : Uint8B
</span></span><span class=line><span class=cl>   +0x990 VirtualTimerListHead : _LIST_ENTRY
</span></span><span class=line><span class=cl>   +0x9a0 WakeChannel      : _WNF_STATE_NAME
</span></span><span class=line><span class=cl>   +0x9a0 WakeInfo         : _PS_PROCESS_WAKE_INFORMATION
</span></span><span class=line><span class=cl>   +0x9d0 MitigationFlags  : Uint4B
</span></span><span class=line><span class=cl>   +0x9d0 MitigationFlagsValues : &lt;unnamed-tag&gt;
</span></span><span class=line><span class=cl>   +0x9d4 MitigationFlags2 : Uint4B
</span></span><span class=line><span class=cl>   +0x9d4 MitigationFlags2Values : &lt;unnamed-tag&gt;
</span></span><span class=line><span class=cl>   +0x9d8 PartitionObject  : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x9e0 SecurityDomain   : Uint8B
</span></span><span class=line><span class=cl>   +0x9e8 ParentSecurityDomain : Uint8B
</span></span><span class=line><span class=cl>   +0x9f0 CoverageSamplerContext : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x9f8 MmHotPatchContext : Ptr64 Void
</span></span><span class=line><span class=cl>   +0xa00 IdealProcessorAssignmentBlock : _KE_IDEAL_PROCESSOR_ASSIGNMENT_BLOCK
</span></span><span class=line><span class=cl>   +0xb18 DynamicEHContinuationTargetsTree : _RTL_AVL_TREE
</span></span><span class=line><span class=cl>   +0xb20 DynamicEHContinuationTargetsLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0xb28 DynamicEnforcedCetCompatibleRanges : _PS_DYNAMIC_ENFORCED_ADDRESS_RANGES
</span></span><span class=line><span class=cl>   +0xb38 DisabledComponentFlags : Uint4B
</span></span><span class=line><span class=cl>   +0xb3c PageCombineSequence : Int4B
</span></span><span class=line><span class=cl>   +0xb40 EnableOptionalXStateFeaturesLock : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0xb48 PathRedirectionHashes : Ptr64 Uint4B
</span></span><span class=line><span class=cl>   +0xb50 SyscallProviderReserved : [4] Ptr64 Void
</span></span><span class=line><span class=cl>   +0xb70 MitigationFlags3 : Uint4B
</span></span><span class=line><span class=cl>   +0xb70 MitigationFlags3Values : &lt;unnamed-tag&gt;
</span></span></code></pre></div><p>I won&rsquo;t cover all of these entries here. But observe that near the top of the structure, we see an entry called <code>ActiveProcessLinks</code>, which is part of a doubly linked-list, containing forward and backwards pointers linking entries together. This EPROCESS list structure contains all the active programs. And if we enable kernel debugging, we can iterate through this list.</p><p>In an elevated Command Prompt, we run <code>bcdedit -debug on</code> and reboot the machine. And then open windbg with administrative privileges.</p><p>In a local kernel debug session, we can now check the PsActiveProcessHead structure and get it&rsquo;s address. This is the structure that the Microsoft utility PsList walks to produce a list of active processes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; x nt!PsActiveProcessHead
</span></span><span class=line><span class=cl>fffff807`25e37f90 nt!PsActiveProcessHead = &lt;no type information&gt;
</span></span></code></pre></div><p>Next let&rsquo;s get the <code>_LIST_ENTRY</code> forward link (Flink) using the address from the <code>PsActiveProcessHead</code> structure:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; dt nt!_LIST_ENTRY fffff807`25e37f90
</span></span><span class=line><span class=cl> [ 0xffffc509`c5488488 - 0xffffc509`cc9d6508 ]
</span></span><span class=line><span class=cl>   +0x000 Flink            : 0xffffc509`c5488488 _LIST_ENTRY [ 0xffffc509`c54f64c8 - 0xfffff807`25e37f90 ]
</span></span><span class=line><span class=cl>   +0x008 Blink            : 0xffffc509`cc9d6508 _LIST_ENTRY [ 0xfffff807`25e37f90 - 0xffffc509`cbf98508 ]   
</span></span></code></pre></div><p>The second thing we need is the offset of the EPROCESS structure&rsquo;s ActiveProcessLinks <code>_LIST_ENTRY</code>, which we can see here at <code>0x448</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; dt nt!_eprocess
</span></span><span class=line><span class=cl>   +0x000 Pcb              : _KPROCESS
</span></span><span class=line><span class=cl>   +0x438 ProcessLock      : _EX_PUSH_LOCK
</span></span><span class=line><span class=cl>   +0x440 UniqueProcessId  : Ptr64 Void
</span></span><span class=line><span class=cl>   +0x448 ActiveProcessLinks : _LIST_ENTRY
</span></span></code></pre></div><p>And now that we have the Flink <code>_LIST_ENTRY</code> address <code>0xffffc509`c5488488</code> — bringing it all together, we can get the first entry (first foward link, or flink) to the ActiveProcessLinks list, and thus the ImageFileName of the first record in the EPROCESS list. We&rsquo;ll use the LIST_ENTRY address and subtract the offset of the ActiveProcessLinks value (0x448).</p><p>What we&rsquo;re doing here essentially is using the offset to locate the beginning of each EPROCESS record. Knowing this, we then tell the debugger we want get both the ActiveProcessLinks.flink, the forward link to the next entry in the linked list, and the ImageFileName of the current entry:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; dt nt!_eprocess 0xffffc509`c5488488-0x448 -y ActiveProcessLinks.flink -y ImageFileName
</span></span><span class=line><span class=cl>   +0x448 ActiveProcessLinks       :  [ 0xffffc509`c54f64c8 - 0xfffff807`25e37f90 ]
</span></span><span class=line><span class=cl>      +0x000 Flink                    : 0xffffc509`c54f64c8 _LIST_ENTRY [ 0xffffc509`c8373488 - 0xffffc509`c5488488 ]
</span></span><span class=line><span class=cl>   +0x5a8 ImageFileName            : [15]  &#34;System&#34;
</span></span></code></pre></div><p>Ah, the System image file name. And we see the next flink that is referenced is <code>0xffffc509`c54f64c8</code>. Let&rsquo;s get the ImageFileName for that entry, too:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; dt nt!_eprocess 0xffffc509`c54f64c8-0x448 -y ActiveProcessLinks.flink -y ImageFileName
</span></span><span class=line><span class=cl>   +0x448 ActiveProcessLinks       :  [ 0xffffc509`c8373488 - 0xffffc509`c5488488 ]
</span></span><span class=line><span class=cl>      +0x000 Flink                    : 0xffffc509`c8373488 _LIST_ENTRY [ 0xffffc509`c8194508 - 0xffffc509`c54f64c8 ]
</span></span><span class=line><span class=cl>   +0x5a8 ImageFileName            : [15]  &#34;Registry&#34;
</span></span></code></pre></div><p>The Registry service! Alright. And once more we see the next address is at <code>0xffffc509`c8373488</code>. We&rsquo;ll get the ImageFileName for that entry as well:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; dt nt!_eprocess 0xffffc509`c8373488-0x448 -y ActiveProcessLinks.flink -y ImageFileName
</span></span><span class=line><span class=cl>   +0x448 ActiveProcessLinks       :  [ 0xffffc509`c8194508 - 0xffffc509`c54f64c8 ]
</span></span><span class=line><span class=cl>      +0x000 Flink                    : 0xffffc509`c8194508 _LIST_ENTRY [ 0xffffc509`ca6794c8 - 0xffffc509`c8373488 ]
</span></span><span class=line><span class=cl>   +0x5a8 ImageFileName            : [15]  &#34;smss.exe&#34;
</span></span></code></pre></div><p>And that&rsquo;s the <code>smss.exe</code> executable, which provides functionality for Microsoft Window&rsquo;s Session Manager Subsystem.</p><p>We could continue walking the EPROCESS list and enumerate every processes forward and backwards pointers. But I won&rsquo;t iterate through all of them manually here.</p><p>The kernel debugger in Windows also provides some nice built-in functionality to make looping through process structures pretty fast. We can use the <code>!process</code> module in the kernel debugger to get information about active processes, like so:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lkd&gt; !process 0 0
</span></span><span class=line><span class=cl>**** NT ACTIVE PROCESS DUMP ****
</span></span><span class=line><span class=cl>PROCESS ffffc509c5488040
</span></span><span class=line><span class=cl>    SessionId: none  Cid: 0004    Peb: 00000000  ParentCid: 0000
</span></span><span class=line><span class=cl>    DirBase: 001ae002  ObjectTable: ffffda878c2aae80  HandleCount: 2748.
</span></span><span class=line><span class=cl>    Image: System
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PROCESS ffffc509c54f6080
</span></span><span class=line><span class=cl>    SessionId: none  Cid: 006c    Peb: 00000000  ParentCid: 0004
</span></span><span class=line><span class=cl>    DirBase: 1031d5002  ObjectTable: ffffda878c259cc0  HandleCount:   0.
</span></span><span class=line><span class=cl>    Image: Registry
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PROCESS ffffc509c8373040
</span></span><span class=line><span class=cl>    SessionId: none  Cid: 01c0    Peb: 5d58682000  ParentCid: 0004
</span></span><span class=line><span class=cl>    DirBase: 10dcb5002  ObjectTable: ffffda878d5909c0  HandleCount:  58.
</span></span><span class=line><span class=cl>    Image: smss.exe
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ...
</span></span></code></pre></div><p>We can verify our work here. The expression <code>0xffffc509`c5488488 - `0x448</code> evaluates to <code>0xffffc509c5488040</code>. So, we know our System value is correct.</p><p>But what about our Registry value? Well, <code>0xffffc509`c54f64c8 - 0x448</code> gives us <code>0xffffc509c54f6080</code>. So our Registry value is also correct.</p><p>And our entry for <code>smss.exe</code> appears to be on accurate as well. Verifying it against the kernel debugger&rsquo;s <code>!process</code> module output, it correctly evaluates to <code>0xffffc509c8373040</code>, which is the result of the offset subtraction we did prior: <code>0xffffc509`c8373488 - 0x448</code>.</p><p>We can use a simple Python script to double check that the offsets we calculated beforehand align with those printed out by the !process module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mh>0x448</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>memory_addresses</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xffffc509c5488488</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xffffc509c54f64c8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xffffc509c8373488</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>address</span> <span class=ow>in</span> <span class=n>memory_addresses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>address</span> <span class=o>-</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>result</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>0xffffc509c5488040
</span></span><span class=line><span class=cl>0xffffc509c54f6080
</span></span><span class=line><span class=cl>0xffffc509c8373040
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://hexagram.foo/tags/windows/>Windows</a></li><li><a href=https://hexagram.foo/tags/windbg/>Windbg</a></li></ul><nav class=paginav><a class=prev href=https://hexagram.foo/posts/using-c-sharp-to-enumerate-windows-processes/><span class=title>« Prev</span><br><span>Using C Sharp to Enumerate Windows Processes</span>
</a><a class=next href=https://hexagram.foo/posts/inference-side-channel-attacks/><span class=title>Next »</span><br><span>Inference: Side-Channel Attacks</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on x" href="https://x.com/intent/tweet/?text=Finding%20Active%20Processes%20with%20Windbg&amp;url=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f&amp;hashtags=windows%2cwindbg"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f&amp;title=Finding%20Active%20Processes%20with%20Windbg&amp;summary=Finding%20Active%20Processes%20with%20Windbg&amp;source=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f&title=Finding%20Active%20Processes%20with%20Windbg"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on whatsapp" href="https://api.whatsapp.com/send?text=Finding%20Active%20Processes%20with%20Windbg%20-%20https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on telegram" href="https://telegram.me/share/url?text=Finding%20Active%20Processes%20with%20Windbg&amp;url=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Finding Active Processes with Windbg on ycombinator" href="https://news.ycombinator.com/submitlink?t=Finding%20Active%20Processes%20with%20Windbg&u=https%3a%2f%2fhexagram.foo%2fposts%2ffinding-active-processes-with-windbg%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://hexagram.foo/>Stephan Bridger</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br><br><hr><br><a href=https://github.com/hexagr/ title="Stephan Bridger on Github">github</a> /
<a href=https://hackerone.com/hexagr/badges/ title="Stephan Bridger on HackerOne">hackerone</a> /
<a href=https://x.com/hexagr title="Stephan Bridger on X.com">x</a> /
<a href=https://flickr.com/hexagr title="Stephan Bridger on flickr">flickr</a> /
<a href=https://mastodon.social/@hexagr rel=me title="Stephan Bridger on mastodon">mastodon</a> /
<a href=https://bsky.app/profile/hexagr.bsky.social title="Stephan Bridger on bluesky">bluesky</a> /
<a href=https://hexagr.blogspot.com title="Stephan Bridger on blogspot">blogspot</a> /
<a href=https://vimeo.com/hexagr title="Stephan Bridger on vimeo">vimeo</a> /
<a href=https://bugcrowd.com/hexagr title="Stephan Bridger on bugcrowd">bugcrowd</a> /
<a href=https://gitlab.com/hexagr title="Stephan Bridger on gitlab">gitlab</a> /
<a href=https://youtube.com/@hexagr/ title="Stephan Bridger on youtube">youtube</a> /
<a href=https://hexagr.tumblr.com title="Stephan Bridger on tumblr">tumblr</a>
</span><span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg></a><style>::-webkit-scrollbar-thumb{opacity:0;transition:opacity .3s ease}body.scrolling ::-webkit-scrollbar-thumb{opacity:1}</style><script>let scrollTimeout;window.addEventListener("scroll",()=>{document.body.classList.add("scrolling"),clearTimeout(scrollTimeout),scrollTimeout=setTimeout(()=>{document.body.classList.remove("scrolling")},1e3)})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>